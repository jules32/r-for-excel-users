<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 dplyr and Pivot Tables | R for Excel Users</title>
  <meta name="description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 dplyr and Pivot Tables | R for Excel Users" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 dplyr and Pivot Tables | R for Excel Users" />
  
  <meta name="twitter:description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  

<meta name="author" content="Julie Lowndes &amp; Allison Horst" />


<meta name="date" content="2019-11-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rmarkdown.html">
<link rel="next" href="vlookup.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Excel Users</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a><ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#summary-a-few-sentences"><i class="fa fa-check"></i><b>2.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#objectives-more-detailed-bulletpoints"><i class="fa fa-check"></i><b>2.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#resources"><i class="fa fa-check"></i><b>2.3</b> Resources</a></li>
<li class="chapter" data-level="2.4" data-path="overview.html"><a href="overview.html#overview-1"><i class="fa fa-check"></i><b>2.4</b> Overview</a><ul>
<li class="chapter" data-level="2.4.1" data-path="overview.html"><a href="overview.html#what-to-expect"><i class="fa fa-check"></i><b>2.4.1</b> What to expect</a></li>
<li class="chapter" data-level="2.4.2" data-path="overview.html"><a href="overview.html#what-youll-learn"><i class="fa fa-check"></i><b>2.4.2</b> What you’ll learn</a></li>
<li class="chapter" data-level="2.4.3" data-path="overview.html"><a href="overview.html#emphasizing-collaboration"><i class="fa fa-check"></i><b>2.4.3</b> Emphasizing collaboration</a></li>
<li class="chapter" data-level="2.4.4" data-path="overview.html"><a href="overview.html#by-the-end-of-the-course"><i class="fa fa-check"></i><b>2.4.4</b> By the end of the course…</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="overview.html"><a href="overview.html#rstudio-orientation"><i class="fa fa-check"></i><b>2.5</b> RStudio Orientation</a><ul>
<li class="chapter" data-level="2.5.1" data-path="overview.html"><a href="overview.html#rstudio-projects"><i class="fa fa-check"></i><b>2.5.1</b> RStudio Projects</a></li>
<li class="chapter" data-level="2.5.2" data-path="overview.html"><a href="overview.html#r-console"><i class="fa fa-check"></i><b>2.5.2</b> R Console</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="overview.html"><a href="overview.html#deep-thought"><i class="fa fa-check"></i><b>2.6</b> Deep thought</a></li>
<li class="chapter" data-level="2.7" data-path="overview.html"><a href="overview.html#r-scripts"><i class="fa fa-check"></i><b>2.7</b> R Scripts</a><ul>
<li class="chapter" data-level="2.7.1" data-path="overview.html"><a href="overview.html#deep-thought-error-messages-are-your-friends"><i class="fa fa-check"></i><b>2.7.1</b> Deep thought: Error messages are your friends</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="overview.html"><a href="overview.html#dont-save-the-workspace"><i class="fa fa-check"></i><b>2.8</b> Don’t save the workspace</a></li>
<li class="chapter" data-level="2.9" data-path="overview.html"><a href="overview.html#deep-thought-keep-the-raw-data-raw."><i class="fa fa-check"></i><b>2.9</b> Deep thought: keep the raw data raw.</a></li>
<li class="chapter" data-level="2.10" data-path="overview.html"><a href="overview.html#activity-1"><i class="fa fa-check"></i><b>2.10</b> Activity 1</a></li>
<li class="chapter" data-level="2.11" data-path="overview.html"><a href="overview.html#activity-2"><i class="fa fa-check"></i><b>2.11</b> Activity 2</a></li>
<li class="chapter" data-level="2.12" data-path="overview.html"><a href="overview.html#efficiency-tips"><i class="fa fa-check"></i><b>2.12</b> Efficiency Tips</a></li>
<li class="chapter" data-level="2.13" data-path="overview.html"><a href="overview.html#troubleshooting"><i class="fa fa-check"></i><b>2.13</b> Troubleshooting</a><ul>
<li class="chapter" data-level="2.13.1" data-path="overview.html"><a href="overview.html#i-entered-a-command-and-nothings-happening"><i class="fa fa-check"></i><b>2.13.1</b> I entered a command and nothing’s happening</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="readxl.html"><a href="readxl.html"><i class="fa fa-check"></i><b>3</b> <code>readxl</code></a><ul>
<li class="chapter" data-level="3.1" data-path="readxl.html"><a href="readxl.html#summary"><i class="fa fa-check"></i><b>3.1</b> Summary</a></li>
<li class="chapter" data-level="3.2" data-path="readxl.html"><a href="readxl.html#objectives"><i class="fa fa-check"></i><b>3.2</b> Objectives</a></li>
<li class="chapter" data-level="3.3" data-path="readxl.html"><a href="readxl.html#resources-1"><i class="fa fa-check"></i><b>3.3</b> Resources</a></li>
<li class="chapter" data-level="3.4" data-path="readxl.html"><a href="readxl.html#lesson"><i class="fa fa-check"></i><b>3.4</b> Lesson</a><ul>
<li class="chapter" data-level="3.4.1" data-path="readxl.html"><a href="readxl.html#lesson-prep-get-data-files-into-your-working-directory"><i class="fa fa-check"></i><b>3.4.1</b> Lesson prep: get data files into your working directory</a></li>
<li class="chapter" data-level="3.4.2" data-path="readxl.html"><a href="readxl.html#create-a-new-.r-script-attach-the-tidyverse-readxl-and-writexl-packages"><i class="fa fa-check"></i><b>3.4.2</b> Create a new .R script, attach the <code>tidyverse</code>, <code>readxl</code> and <code>writexl</code> packages</a></li>
<li class="chapter" data-level="3.4.3" data-path="readxl.html"><a href="readxl.html#use-readrread_csv-to-read-in-data-from-a-csv-file"><i class="fa fa-check"></i><b>3.4.3</b> Use <code>readr::read_csv()</code> to read in data from a CSV file</a></li>
<li class="chapter" data-level="3.4.4" data-path="readxl.html"><a href="readxl.html#use-readxlread_excel-to-read-in-a-single-excel-worksheet"><i class="fa fa-check"></i><b>3.4.4</b> Use <code>readxl::read_excel()</code> to read in a single Excel worksheet</a></li>
<li class="chapter" data-level="3.4.5" data-path="readxl.html"><a href="readxl.html#use-readxlread_excel-to-read-in-only-part-of-an-excel-worksheet"><i class="fa fa-check"></i><b>3.4.5</b> Use <code>readxl::read_excel()</code> to read in only <em>part</em> of an Excel worksheet</a></li>
<li class="chapter" data-level="3.4.6" data-path="readxl.html"><a href="readxl.html#use-readxlread_excel-to-read-in-selected-worksheets-from-a-workbook"><i class="fa fa-check"></i><b>3.4.6</b> Use <code>readxl::read_excel()</code> to read in selected worksheets from a workbook</a></li>
<li class="chapter" data-level="3.4.7" data-path="readxl.html"><a href="readxl.html#read-in-and-combine-data-from-multiple-worksheets-into-a-data-frame-simultaneously-with-purrrmap_df"><i class="fa fa-check"></i><b>3.4.7</b> Read in and combine data from multiple worksheets into a data frame simultaneously with <code>purrr::map_df()</code></a></li>
<li class="chapter" data-level="3.4.8" data-path="readxl.html"><a href="readxl.html#save-data-frames-as-.csv-or-.xlsx-with-readrwrite_csv-or-writexlwrite_xlsx"><i class="fa fa-check"></i><b>3.4.8</b> Save data frames as .csv or .xlsx with <code>readr::write_csv()</code> or <code>writexl::write_xlsx()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="readxl.html"><a href="readxl.html#fun-facts-ideas"><i class="fa fa-check"></i><b>3.5</b> Fun facts ideas:</a></li>
<li class="chapter" data-level="3.6" data-path="readxl.html"><a href="readxl.html#interludes-deep-thoughtsopenscapes"><i class="fa fa-check"></i><b>3.6</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="3.7" data-path="readxl.html"><a href="readxl.html#activity-import-some-invertebrates"><i class="fa fa-check"></i><b>3.7</b> Activity: Import some invertebrates!</a></li>
<li class="chapter" data-level="3.8" data-path="readxl.html"><a href="readxl.html#efficiency-tips-1"><i class="fa fa-check"></i><b>3.8</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>4</b> RMarkdown</a><ul>
<li class="chapter" data-level="4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#summary-a-few-sentences-1"><i class="fa fa-check"></i><b>4.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#objectives-more-detailed-bulletpoints-1"><i class="fa fa-check"></i><b>4.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="4.3" data-path="rmarkdown.html"><a href="rmarkdown.html#resources-2"><i class="fa fa-check"></i><b>4.3</b> Resources</a></li>
<li class="chapter" data-level="4.4" data-path="rmarkdown.html"><a href="rmarkdown.html#intro-to-rmarkdown"><i class="fa fa-check"></i><b>4.4</b> Intro to RMarkdown</a><ul>
<li class="chapter" data-level="4.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#activity"><i class="fa fa-check"></i><b>4.4.1</b> Activity</a></li>
<li class="chapter" data-level="4.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#code-chunks"><i class="fa fa-check"></i><b>4.4.2</b> Code chunks</a></li>
<li class="chapter" data-level="4.4.3" data-path="rmarkdown.html"><a href="rmarkdown.html#activity-3"><i class="fa fa-check"></i><b>4.4.3</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="rmarkdown.html"><a href="rmarkdown.html#create-a-rmd-for-our-fish-analysis"><i class="fa fa-check"></i><b>4.5</b> Create a Rmd for our fish analysis</a></li>
<li class="chapter" data-level="4.6" data-path="rmarkdown.html"><a href="rmarkdown.html#tidy-data"><i class="fa fa-check"></i><b>4.6</b> Tidy data</a></li>
<li class="chapter" data-level="4.7" data-path="rmarkdown.html"><a href="rmarkdown.html#activity-4"><i class="fa fa-check"></i><b>4.7</b> Activity</a></li>
<li class="chapter" data-level="4.8" data-path="rmarkdown.html"><a href="rmarkdown.html#fun-facts-quirky-things---making-a-note-of-these-wherever-possible-for-interest-little-did-you-know-sections"><i class="fa fa-check"></i><b>4.8</b> Fun facts (quirky things) - making a note of these wherever possible for interest (little “Did you know?” sections)</a></li>
<li class="chapter" data-level="4.9" data-path="rmarkdown.html"><a href="rmarkdown.html#interludes-deep-thoughtsopenscapes-1"><i class="fa fa-check"></i><b>4.9</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="4.10" data-path="rmarkdown.html"><a href="rmarkdown.html#interludes-deep-thoughtsopenscapes-2"><i class="fa fa-check"></i><b>4.10</b> Interludes (deep thoughts/openscapes)</a><ul>
<li class="chapter" data-level="4.10.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-video-1-minute"><i class="fa fa-check"></i><b>4.10.1</b> RMarkdown video (1-minute)</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="rmarkdown.html"><a href="rmarkdown.html#efficiency-tips-2"><i class="fa fa-check"></i><b>4.11</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pivot.html"><a href="pivot.html"><i class="fa fa-check"></i><b>5</b> <code>dplyr</code> and Pivot Tables</a><ul>
<li class="chapter" data-level="5.1" data-path="pivot.html"><a href="pivot.html#summary-a-few-sentences-2"><i class="fa fa-check"></i><b>5.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="5.2" data-path="pivot.html"><a href="pivot.html#objectives-more-detailed-bulletpoints-2"><i class="fa fa-check"></i><b>5.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="5.3" data-path="pivot.html"><a href="pivot.html#resources-3"><i class="fa fa-check"></i><b>5.3</b> Resources</a></li>
<li class="chapter" data-level="5.4" data-path="pivot.html"><a href="pivot.html#introduction-our-analytical-plan"><i class="fa fa-check"></i><b>5.4</b> Introduction / our analytical plan</a></li>
<li class="chapter" data-level="5.5" data-path="pivot.html"><a href="pivot.html#what-are-pivot-tables"><i class="fa fa-check"></i><b>5.5</b> What are pivot tables?</a></li>
<li class="chapter" data-level="5.6" data-path="pivot.html"><a href="pivot.html#dplyr-overview"><i class="fa fa-check"></i><b>5.6</b> <code>dplyr</code> overview</a></li>
<li class="chapter" data-level="5.7" data-path="pivot.html"><a href="pivot.html#pivot-tables-group_by-summarize"><i class="fa fa-check"></i><b>5.7</b> pivot tables: <code>group_by() %&gt;% summarize()</code></a></li>
<li class="chapter" data-level="5.8" data-path="pivot.html"><a href="pivot.html#mutate"><i class="fa fa-check"></i><b>5.8</b> <code>mutate()</code></a><ul>
<li class="chapter" data-level="5.8.1" data-path="pivot.html"><a href="pivot.html#activity-5"><i class="fa fa-check"></i><b>5.8.1</b> Activity</a></li>
<li class="chapter" data-level="5.8.2" data-path="pivot.html"><a href="pivot.html#group_by-mutate"><i class="fa fa-check"></i><b>5.8.2</b> <code>group_by() %&gt;% mutate()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="pivot.html"><a href="pivot.html#mutate-vs-summarize"><i class="fa fa-check"></i><b>5.9</b> mutate() vs summarize()</a></li>
<li class="chapter" data-level="5.10" data-path="pivot.html"><a href="pivot.html#deep-thoughts"><i class="fa fa-check"></i><b>5.10</b> Deep thoughts</a></li>
<li class="chapter" data-level="5.11" data-path="pivot.html"><a href="pivot.html#efficiency-tips-3"><i class="fa fa-check"></i><b>5.11</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vlookup.html"><a href="vlookup.html"><i class="fa fa-check"></i><b>6</b> Dplyr and vlookups</a><ul>
<li class="chapter" data-level="6.1" data-path="vlookup.html"><a href="vlookup.html#summary-1"><i class="fa fa-check"></i><b>6.1</b> Summary</a></li>
<li class="chapter" data-level="6.2" data-path="vlookup.html"><a href="vlookup.html#objectives-1"><i class="fa fa-check"></i><b>6.2</b> Objectives</a></li>
<li class="chapter" data-level="6.3" data-path="vlookup.html"><a href="vlookup.html#resources-4"><i class="fa fa-check"></i><b>6.3</b> Resources</a></li>
<li class="chapter" data-level="6.4" data-path="vlookup.html"><a href="vlookup.html#lessons"><i class="fa fa-check"></i><b>6.4</b> Lessons</a><ul>
<li class="chapter" data-level="6.4.1" data-path="vlookup.html"><a href="vlookup.html#dplyrfilter-to-conditionally-subset-by-rows"><i class="fa fa-check"></i><b>6.4.1</b> <code>dplyr::filter()</code> to conditionally subset by rows</a></li>
<li class="chapter" data-level="6.4.2" data-path="vlookup.html"><a href="vlookup.html#merging-data-frames-with-dplyr_join"><i class="fa fa-check"></i><b>6.4.2</b> Merging data frames with <code>dplyr::*_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="vlookup.html"><a href="vlookup.html#fun-facts"><i class="fa fa-check"></i><b>6.5</b> Fun facts</a></li>
<li class="chapter" data-level="6.6" data-path="vlookup.html"><a href="vlookup.html#interludes-deep-thoughtsopenscapes-3"><i class="fa fa-check"></i><b>6.6</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="6.7" data-path="vlookup.html"><a href="vlookup.html#our-turn-your-turn-1"><i class="fa fa-check"></i><b>6.7</b> Our Turn Your Turn 1</a></li>
<li class="chapter" data-level="6.8" data-path="vlookup.html"><a href="vlookup.html#our-turn-your-turn-2"><i class="fa fa-check"></i><b>6.8</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="6.9" data-path="vlookup.html"><a href="vlookup.html#efficiency-tips-4"><i class="fa fa-check"></i><b>6.9</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidying.html"><a href="tidying.html"><i class="fa fa-check"></i><b>7</b> Tidying</a><ul>
<li class="chapter" data-level="7.1" data-path="tidying.html"><a href="tidying.html#better-practices-needs-a-better-name"><i class="fa fa-check"></i><b>7.1</b> Better practices [needs a better name]</a></li>
<li class="chapter" data-level="7.2" data-path="tidying.html"><a href="tidying.html#summary-a-few-sentences-3"><i class="fa fa-check"></i><b>7.2</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="7.3" data-path="tidying.html"><a href="tidying.html#objectives-more-detailed-bulletpoints-3"><i class="fa fa-check"></i><b>7.3</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="7.4" data-path="tidying.html"><a href="tidying.html#resources-5"><i class="fa fa-check"></i><b>7.4</b> Resources</a></li>
<li class="chapter" data-level="7.5" data-path="tidying.html"><a href="tidying.html#lessons-teaching-for-each-objective..-objectives-examples"><i class="fa fa-check"></i><b>7.5</b> Lessons teaching for each objective….. (objectives, examples)</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tidying.html"><a href="tidying.html#expect-theres-a-better-way-chat"><i class="fa fa-check"></i><b>7.5.1</b> Expect there’s a better way chat</a></li>
<li class="chapter" data-level="7.5.2" data-path="tidying.html"><a href="tidying.html#janitor"><i class="fa fa-check"></i><b>7.5.2</b> Janitor</a></li>
<li class="chapter" data-level="7.5.3" data-path="tidying.html"><a href="tidying.html#example-how-to-google"><i class="fa fa-check"></i><b>7.5.3</b> Example: How to Google</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tidying.html"><a href="tidying.html#fun-facts-quirky-things---making-a-note-of-these-wherever-possible-for-interest-little-did-you-know-sections-1"><i class="fa fa-check"></i><b>7.6</b> Fun facts (quirky things) - making a note of these wherever possible for interest (little “Did you know?” sections)</a></li>
<li class="chapter" data-level="7.7" data-path="tidying.html"><a href="tidying.html#interludes-deep-thoughtsopenscapes-4"><i class="fa fa-check"></i><b>7.7</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="7.8" data-path="tidying.html"><a href="tidying.html#our-turn-your-turn-2-1"><i class="fa fa-check"></i><b>7.8</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="7.9" data-path="tidying.html"><a href="tidying.html#efficiency-tips-5"><i class="fa fa-check"></i><b>7.9</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="format.html"><a href="format.html"><i class="fa fa-check"></i><b>8</b> Formatting and Sharing</a><ul>
<li class="chapter" data-level="8.1" data-path="format.html"><a href="format.html#summary-a-few-sentences-4"><i class="fa fa-check"></i><b>8.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="8.2" data-path="format.html"><a href="format.html#objectives-more-detailed-bulletpoints-4"><i class="fa fa-check"></i><b>8.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="8.3" data-path="format.html"><a href="format.html#resources-6"><i class="fa fa-check"></i><b>8.3</b> Resources</a></li>
<li class="chapter" data-level="8.4" data-path="format.html"><a href="format.html#introduction-our-analytical-plan-1"><i class="fa fa-check"></i><b>8.4</b> Introduction / our analytical plan</a></li>
<li class="chapter" data-level="8.5" data-path="format.html"><a href="format.html#formatting-tables-15-minutes"><i class="fa fa-check"></i><b>8.5</b> Formatting tables (15 minutes)</a><ul>
<li class="chapter" data-level="8.5.1" data-path="format.html"><a href="format.html#dt"><i class="fa fa-check"></i><b>8.5.1</b> DT</a></li>
<li class="chapter" data-level="8.5.2" data-path="format.html"><a href="format.html#kable-and-kablextra"><i class="fa fa-check"></i><b>8.5.2</b> kable and kablextra</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="format.html"><a href="format.html#activity-5-min"><i class="fa fa-check"></i><b>8.6</b> Activity (5 min)</a></li>
<li class="chapter" data-level="8.7" data-path="format.html"><a href="format.html#github-for-publishing"><i class="fa fa-check"></i><b>8.7</b> GitHub for Publishing</a><ul>
<li class="chapter" data-level="8.7.1" data-path="format.html"><a href="format.html#issues"><i class="fa fa-check"></i><b>8.7.1</b> Issues</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="format.html"><a href="format.html#create-a-github-user-account"><i class="fa fa-check"></i><b>8.8</b> Create a GitHub user account</a></li>
<li class="chapter" data-level="8.9" data-path="format.html"><a href="format.html#create-a-repo"><i class="fa fa-check"></i><b>8.9</b> Create a repo</a><ul>
<li class="chapter" data-level="8.9.1" data-path="format.html"><a href="format.html#create-a-gh-pages-branch"><i class="fa fa-check"></i><b>8.9.1</b> Create a gh-pages branch</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="format.html"><a href="format.html#drag-and-drop"><i class="fa fa-check"></i><b>8.10</b> Drag and Drop</a></li>
<li class="chapter" data-level="8.11" data-path="format.html"><a href="format.html#visit-your-website"><i class="fa fa-check"></i><b>8.11</b> Visit your website!</a></li>
<li class="chapter" data-level="8.12" data-path="format.html"><a href="format.html#edit-the-readme"><i class="fa fa-check"></i><b>8.12</b> Edit the README</a></li>
<li class="chapter" data-level="8.13" data-path="format.html"><a href="format.html#activity-5-min-1"><i class="fa fa-check"></i><b>8.13</b> Activity (5 min)</a></li>
<li class="chapter" data-level="8.14" data-path="format.html"><a href="format.html#recap"><i class="fa fa-check"></i><b>8.14</b> recap</a></li>
<li class="chapter" data-level="8.15" data-path="format.html"><a href="format.html#interludes-deep-thoughtsopenscapes-5"><i class="fa fa-check"></i><b>8.15</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="8.16" data-path="format.html"><a href="format.html#efficiency-tips-6"><i class="fa fa-check"></i><b>8.16</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="synthesis.html"><a href="synthesis.html"><i class="fa fa-check"></i><b>9</b> Synthesis</a><ul>
<li class="chapter" data-level="9.1" data-path="synthesis.html"><a href="synthesis.html#summary-a-few-sentences-5"><i class="fa fa-check"></i><b>9.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="9.2" data-path="synthesis.html"><a href="synthesis.html#objectives-more-detailed-bulletpoints-5"><i class="fa fa-check"></i><b>9.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="9.3" data-path="synthesis.html"><a href="synthesis.html#resources-7"><i class="fa fa-check"></i><b>9.3</b> Resources</a></li>
<li class="chapter" data-level="9.4" data-path="synthesis.html"><a href="synthesis.html#lessons-teaching-for-each-objective..-objectives-examples-1"><i class="fa fa-check"></i><b>9.4</b> Lessons teaching for each objective….. (objectives, examples)</a></li>
<li class="chapter" data-level="9.5" data-path="synthesis.html"><a href="synthesis.html#fun-facts-quirky-things---making-a-note-of-these-wherever-possible-for-interest-little-did-you-know-sections-2"><i class="fa fa-check"></i><b>9.5</b> Fun facts (quirky things) - making a note of these wherever possible for interest (little “Did you know?” sections)</a></li>
<li class="chapter" data-level="9.6" data-path="synthesis.html"><a href="synthesis.html#interludes-deep-thoughtsopenscapes-6"><i class="fa fa-check"></i><b>9.6</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="9.7" data-path="synthesis.html"><a href="synthesis.html#our-turn-your-turn-1-1"><i class="fa fa-check"></i><b>9.7</b> Our Turn Your Turn 1</a></li>
<li class="chapter" data-level="9.8" data-path="synthesis.html"><a href="synthesis.html#our-turn-your-turn-2-2"><i class="fa fa-check"></i><b>9.8</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="9.9" data-path="synthesis.html"><a href="synthesis.html#efficiency-tips-7"><i class="fa fa-check"></i><b>9.9</b> Efficiency Tips</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Excel Users</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pivot" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> <code>dplyr</code> and Pivot Tables</h1>
<div id="summary-a-few-sentences-2" class="section level2">
<h2><span class="header-section-number">5.1</span> Summary (a few sentences)</h2>
<p>First of two chapters on data wrangling, here focused on pivot tables.</p>
</div>
<div id="objectives-more-detailed-bulletpoints-2" class="section level2">
<h2><span class="header-section-number">5.2</span> Objectives (more detailed, bulletpoints?)</h2>
<p>In R, we can use dplyr for pivot tables by using 2 main verbs in combination: <code>group_by</code> and <code>summarize</code>, and that’s where we’ll start. Then, we will learn 2 critical verbs that are powerful for data wrangling: <code>mutate</code> and <code>select</code>.</p>
<p>We will also continue to emphasize reproducibility in all our analyses.</p>
</div>
<div id="resources-3" class="section level2">
<h2><span class="header-section-number">5.3</span> Resources</h2>
<ul>
<li><a href="https://dplyr.tidyverse.org/">dplyr.tidyverse.org</a></li>
<li><a href="https://r4ds.had.co.nz/transform.html">R for Data Science: Transform Chapter</a></li>
</ul>
</div>
<div id="introduction-our-analytical-plan" class="section level2">
<h2><span class="header-section-number">5.4</span> Introduction / our analytical plan</h2>
<p>We are going to continue with our analysis with the fish-counts data. So far, our RMarkdown has the following in the “setup” chunk: <!---TODO update after ch 3 complete ---></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## attach libraries</span>
<span class="kw">library</span>(tidyverse)

<span class="co">## read in data</span>
fish_counts &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;fish_counts_curated.csv&quot;</span>)</code></pre>
<p>And we have explored the data by looking at some summary statistics and making a simple plot. Now, we are going to learn how to wrangle data in R, using the <code>dplyr</code> package which is included in the <code>tidyverse</code>. In this session, we’ll focus on the functions in <code>dplyr</code> that operate like pivot tables.</p>
<p>This is because what we want to do with our fish_counts data is XXXXX.</p>
</div>
<div id="what-are-pivot-tables" class="section level2">
<h2><span class="header-section-number">5.5</span> What are pivot tables?</h2>
<p>TODO:</p>
<ul>
<li>what they are</li>
<li>what they allow you to do</li>
</ul>
<p>Let’s talk about how this looks like in R.</p>
</div>
<div id="dplyr-overview" class="section level2">
<h2><span class="header-section-number">5.6</span> <code>dplyr</code> overview</h2>
<!---
> Data scientists, according to interviews and expert estimates, spend from 50 percent to 80 percent of their time mired in the mundane labor of collecting and preparing data, before it can be explored for useful information. - [NYTimes (2014)](http://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html)
--->
<p><code>dplyr</code> is a grammar of data manipulation that provides a consistent set of verbs that help you solve the most common data manipulation challenges. These common verbs are:</p>
<ul>
<li><p><strong><code>filter()</code></strong>: pick observations by their values</p>
<img src="img/rstudio-cheatsheet-filter.png" width="300"/></li>
<li><p><strong><code>select()</code></strong>: pick variables by their names</p>
<img src="img/rstudio-cheatsheet-select.png" width="300"/></li>
<li><p><strong><code>mutate()</code></strong>: create new variables with functions of existing variables</p>
<img src="img/rstudio-cheatsheet-mutate.png" width="300"/></li>
<li><p><strong><code>summarise()</code></strong>: collapse many values down to a single summary</p>
<img src="img/rstudio-cheatsheet-summarise.png" width="300"/></li>
<li><p><strong><code>arrange()</code></strong>: reorder the rows</p></li>
</ul>
<p>These can all be used in conjunction with <code>group_by()</code> which changes the scope of each function from operating on the entire dataset to operating on it group-by-group. These six functions provide the verbs for a language of data manipulation.</p>
<p>All verbs work similarly:</p>
<ol style="list-style-type: decimal">
<li>The first argument is a data frame.</li>
<li>The subsequent arguments describe what to do with the data frame. You can refer to columns in the data frame directly without using <code>$</code>.</li>
<li>The result is a new data frame.</li>
</ol>
<p>Together these properties make it easy to chain together multiple simple steps to achieve a complex result using the pipe operator <code>%&gt;%</code>.</p>
<p>I love thinking of these <code>dplyr</code> verbs and the pipe operator <code>%&gt;%</code> as telling a story. When I see <code>%&gt;%</code> I think “and then”:</p>
<pre class="sourceCode r"><code class="sourceCode r">data <span class="op">%&gt;%</span><span class="st">          </span><span class="co"># start with data, and then</span>
<span class="st">  </span><span class="kw">group_by</span>() <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># group by a variable, and then</span>
<span class="st">  </span><span class="kw">mutate</span>() <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># mutate to add a new column, and then</span>
<span class="st">  </span><span class="kw">select</span>()        <span class="co"># select specific columns</span></code></pre>
</div>
<div id="pivot-tables-group_by-summarize" class="section level2">
<h2><span class="header-section-number">5.7</span> pivot tables: <code>group_by() %&gt;% summarize()</code></h2>
<p>In R, we can create the functionality of pivot tables by using 2 main <code>dplyr</code> verbs in combination: <code>group_by</code> and <code>summarize</code>.</p>
<p>Say it with me: “pivot tables are group_by and then summarize”. And just like pivot tables, you have flexibility with how you are going to summarize. For example, we can calculate an average, or a total.</p>
<p>Let’s try this on our <code>fish_counts</code> data. Let’s summarize this data by calculating the the total number of fish by type, which in our dataframe is called <code>common_name</code>. We’ll use the pipe operator <code>%&gt;%</code></p>
<pre class="sourceCode r"><code class="sourceCode r">fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(common_name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">total_fish =</span> <span class="kw">sum</span>(total_count)) <span class="co"># within summarize, we name a new column and calculate the sum.</span></code></pre>
<pre><code>## # A tibble: 5 x 2
##   common_name     total_fish
##   &lt;chr&gt;                &lt;dbl&gt;
## 1 black surfperch         94
## 2 blacksmith              46
## 3 garibaldi               24
## 4 rock wrasse             91
## 5 senorita               256</code></pre>
<p>This returns output summarizing the total_fish for each fish. There are way more senorita fish than any other kind!</p>
<p>Notice how together, group_by and summarize collapse the amount of information we see. We lose the other columns that aren’t involved here; we no longer have <code>year</code>, <code>common_name</code>, or <code>total_count</code>. This is also what you would expect from a pivot table.</p>
<p>Question: What if you <em>don’t</em> group_by first? Let’s try it and discuss what’s going on.</p>
<pre class="sourceCode r"><code class="sourceCode r">fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">total_fish =</span> <span class="kw">sum</span>(total_count))</code></pre>
<pre><code>## # A tibble: 1 x 1
##   total_fish
##        &lt;dbl&gt;
## 1        511</code></pre>
<p>So if we don’t <code>group_by</code> first, we will get a single summary statistic (total in this case) for the whole dataset. Useful in some cases for sure. But being able to do it so easily by group can be very powerful.</p>
<p>Let’s now check the <code>fish_counts</code> variable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(fish_counts)</code></pre>
<p>We see that we haven’t changed any of our original data that was stored in this variable. But maybe we do want to save this summary as a variable so we can refer to it or even include it in further analyses. So let’s add a variable assignment to that first line:</p>
<pre class="sourceCode r"><code class="sourceCode r">common_name_summary &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(common_name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">total_fish =</span> <span class="kw">sum</span>(total_count))</code></pre>
<!---TODO::: uncount %>% group_by %>% summarize by mean and sd --->
<p>Now let’s summarize by site. We will assign it to a variable called <code>site_summary</code>. How do we do that? Let’s do it together: <!---also could be an activity---></p>
<pre class="sourceCode r"><code class="sourceCode r">site_summary &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(site) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">total_fish =</span> <span class="kw">sum</span>(total_count))</code></pre>
<p>Great. It can be useful to summarize by both site and year, so that we can learn a little more about how things change over time across sites. And, awesomely, we are able to <code>group_by</code> more than one variable. Let’s do this together, and assign this to a new variable called <code>site_year_summary</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">site_year_summary &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">total_fish =</span> <span class="kw">sum</span>(total_count))

site_year_summary</code></pre>
<pre><code>## # A tibble: 9 x 3
## # Groups:   site [3]
##   site   year total_fish
##   &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 abur   2016         64
## 2 abur   2017        127
## 3 abur   2018          5
## 4 aque   2016         61
## 5 aque   2017          5
## 6 aque   2018         44
## 7 mohk   2016         25
## 8 mohk   2017         99
## 9 mohk   2018         81</code></pre>
<p>OK, so this is awesome. We can see the total counts for each site by year, and have this saved here in a nice variable.</p>
<p>We will revisit this in a moment, but now let’s move on to our next <code>dplyr</code> verb.</p>
</div>
<div id="mutate" class="section level2">
<h2><span class="header-section-number">5.8</span> <code>mutate()</code></h2>
<p>We use the <code>mutate()</code> function to add columns to a data frame. This is one of the most common things that I do in Excel: you need to name the new column, and then you can fill it with new values. From the help pages, we learn that unlike <code>summarize()</code>, <code>mutate()</code> preserves the number of rows of the input. Additionally, new variables overwrite existing variables of the same name.</p>
<p>Let’s say we need to add a column that indicates that these observations were made by SCUBA diving. To do this, first we tell R we want to add a new column using the <code>mutate()</code> function. Then, we tell it the name of the column we want, let’s call it <code>observation_type</code>. Then, we tell it the value we want in the cells: let’s say <code>&quot;SCUBA&quot;</code>. We need to put SCUBA in quotes:</p>
<pre class="sourceCode r"><code class="sourceCode r">fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">observation_type =</span> <span class="st">&quot;SCUBA&quot;</span>)</code></pre>
<pre><code>## # A tibble: 45 x 5
##     year site  common_name     total_count observation_type
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;           
##  1  2016 abur  black surfperch           2 SCUBA           
##  2  2016 abur  blacksmith                1 SCUBA           
##  3  2016 abur  garibaldi                 1 SCUBA           
##  4  2016 abur  rock wrasse               2 SCUBA           
##  5  2016 abur  senorita                 58 SCUBA           
##  6  2016 aque  black surfperch           1 SCUBA           
##  7  2016 aque  blacksmith                1 SCUBA           
##  8  2016 aque  garibaldi                 1 SCUBA           
##  9  2016 aque  rock wrasse               1 SCUBA           
## 10  2016 aque  senorita                 57 SCUBA           
## # … with 35 more rows</code></pre>
<p>Notice that when you just give one value like “SCUBA”, mutate will repeat this value for you; it’s the equivalent in Excel to when you grab the bottom right corner of a cell and drag down.</p>
<p>Let’s try a calculation. Let’s calculate the total count for the whole data site as we did above. We add a new column named <code>total_fish</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total_fish =</span> <span class="kw">sum</span>(total_count))</code></pre>
<pre><code>## # A tibble: 45 x 5
##     year site  common_name     total_count total_fish
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;      &lt;dbl&gt;
##  1  2016 abur  black surfperch           2        511
##  2  2016 abur  blacksmith                1        511
##  3  2016 abur  garibaldi                 1        511
##  4  2016 abur  rock wrasse               2        511
##  5  2016 abur  senorita                 58        511
##  6  2016 aque  black surfperch           1        511
##  7  2016 aque  blacksmith                1        511
##  8  2016 aque  garibaldi                 1        511
##  9  2016 aque  rock wrasse               1        511
## 10  2016 aque  senorita                 57        511
## # … with 35 more rows</code></pre>
<p>And notice that this was the same calculated value as when we did this with summarize, but here it is repeated for every row instead of being collapsed.</p>
<div id="activity-5" class="section level3">
<h3><span class="header-section-number">5.8.1</span> Activity</h3>
<p>Take 3 minutes to add a new column to the data frame; discuss with your neighbor for ideas!</p>
</div>
<div id="group_by-mutate" class="section level3">
<h3><span class="header-section-number">5.8.2</span> <code>group_by() %&gt;% mutate()</code></h3>
<p>So there are many things you could add to a new column; but let’s focus on how powerful mutate can be in combination with <code>group_by</code>. So just like we were just doing <code>group_by() %&gt;% summarize()</code>, we can do <code>group_by() %&gt;% mutate()</code>.</p>
<p>Let’s add a new column named <code>siteyear_counts</code>, and we will calculated after grouping by site and year. Let’s have a look at it first, and then we will assign it as a variable in a moment.</p>
<pre class="sourceCode r"><code class="sourceCode r">fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">siteyear_counts =</span> <span class="kw">sum</span>(total_count))</code></pre>
<pre><code>## # A tibble: 45 x 5
## # Groups:   site, year [9]
##     year site  common_name     total_count siteyear_counts
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;           &lt;dbl&gt;
##  1  2016 abur  black surfperch           2              64
##  2  2016 abur  blacksmith                1              64
##  3  2016 abur  garibaldi                 1              64
##  4  2016 abur  rock wrasse               2              64
##  5  2016 abur  senorita                 58              64
##  6  2016 aque  black surfperch           1              61
##  7  2016 aque  blacksmith                1              61
##  8  2016 aque  garibaldi                 1              61
##  9  2016 aque  rock wrasse               1              61
## 10  2016 aque  senorita                 57              61
## # … with 35 more rows</code></pre>
<p>We now have an additional column in our dataframe called <code>siteyear_counts</code>. And again, if we recall from our <code>site_year_summary</code> above, it has calculated the same information. But instead of collapsing our dataframe, we retain all of the information from the other columns, and the <code>siteyear_counts</code> column will have values that are repeated.</p>
</div>
</div>
<div id="mutate-vs-summarize" class="section level2">
<h2><span class="header-section-number">5.9</span> mutate() vs summarize()</h2>
<p>Why would you use <code>mutate</code> instead of <code>summarize</code>? Why would you ever want to have that <code>siteyear_counts</code> column with values repeated like we just did? Why wouldn’t you always do <code>group_by() %&gt;% summarize()</code> rather than <code>group_by() %&gt;% mutate()</code>? The truth is, there is no one way to do anything in R, but there are ways to make your analyses have fewer steps or read more nicely. Let’s explore this by doing a bit of analysis.</p>
<p>Let’s say we want to calculate the percentage of fish type at each site. This means we are going to do a calculation using both the raw and summary data. And we’re going to do it in 2 ways, first using <code>group_by() %&gt;% summarize()</code> and then <code>group_by() %&gt;% mutate()</code>.</p>
<p>Let’s start off doing this as a <code>group_by() %&gt;% mutate()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">fish_percs &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">siteyear_counts =</span> <span class="kw">sum</span>(total_count)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc_fish =</span> total_count<span class="op">/</span>siteyear_counts<span class="op">*</span><span class="dv">100</span>)</code></pre>
<p>When I’m doing analyses, I like <code>group_by() %&gt;% mutate()</code> because I can build out the logic step-by-step and actually look at it as it builds. It’s both comforting and good for error-checks; I can do what we call “spot checks” of calculating a few values by hand to make sure it’s working. This would also be relatively easy for someone else to follow.</p>
<p>(Again here we can see that senorita fish really dominate each site-year combination).</p>
<p>If we wanted to do this with <code>group_by() %&gt;% summarize()</code> we would need a few more steps. We can write it up as pseudo-code:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## first calculate fish siteyear_counts</span>
x &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">siteyear_counts =</span> <span class="kw">sum</span>(total_count)) 

<span class="co">## then somehow join or merge that information to the fish_counts data </span>
x <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc_fish =</span> total_count<span class="op">/</span>siteyear_counts<span class="op">*</span><span class="dv">100</span>)</code></pre>
<p>In order to calculate the percentages with the appropriate values, we need to somehow join the summarized data back to the fish_counts. This actually requires a few more dplyr verbs: filter and *_join; we will do this tomorrow! <!---TODISCUSS w/ Allison: does this cliffhanger make sense?---></p>
<p>count column (would have to uncount first)</p>
</div>
<div id="deep-thoughts" class="section level2">
<h2><span class="header-section-number">5.10</span> Deep thoughts</h2>
<p>Highly recommended read: <a href="https://peerj.com/preprints/3183/">Broman &amp; Woo: Data organization in spreadsheets</a>. Practical tips to make spreadsheets less error-prone, easier for computers to process, easier to share</p>
<p>Great opening line: “Spreadsheets, for all of their mundane rectangularness, have been the subject of angst and controversy for decades.”</p>
</div>
<div id="efficiency-tips-3" class="section level2">
<h2><span class="header-section-number">5.11</span> Efficiency Tips</h2>
<p>arrow keys with shift, option, command</p>
<!---And that's the end of Day 1! --->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rmarkdown.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="vlookup.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["R for Excel Users.pdf", "R for Excel Users.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
