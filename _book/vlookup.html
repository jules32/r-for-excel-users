<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Dplyr and vlookups | R for the Excel User</title>
  <meta name="description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  <meta name="generator" content="bookdown 0.13.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Dplyr and vlookups | R for the Excel User" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Dplyr and vlookups | R for the Excel User" />
  
  <meta name="twitter:description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  

<meta name="author" content="Julie Lowndes &amp; Allison Horst" />


<meta name="date" content="2019-10-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pivot.html"/>
<link rel="next" href="tidying.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Excel Users</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a><ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#summary-a-few-sentences"><i class="fa fa-check"></i><b>2.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#objectives-more-detailed-bulletpoints"><i class="fa fa-check"></i><b>2.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#resources"><i class="fa fa-check"></i><b>2.3</b> Resources</a></li>
<li class="chapter" data-level="2.4" data-path="overview.html"><a href="overview.html#overview-1"><i class="fa fa-check"></i><b>2.4</b> Overview</a><ul>
<li class="chapter" data-level="2.4.1" data-path="overview.html"><a href="overview.html#what-to-expect"><i class="fa fa-check"></i><b>2.4.1</b> What to expect</a></li>
<li class="chapter" data-level="2.4.2" data-path="overview.html"><a href="overview.html#what-youll-learn"><i class="fa fa-check"></i><b>2.4.2</b> What you’ll learn</a></li>
<li class="chapter" data-level="2.4.3" data-path="overview.html"><a href="overview.html#emphasizing-collaboration"><i class="fa fa-check"></i><b>2.4.3</b> Emphasizing collaboration</a></li>
<li class="chapter" data-level="2.4.4" data-path="overview.html"><a href="overview.html#by-the-end-of-the-course"><i class="fa fa-check"></i><b>2.4.4</b> By the end of the course…</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="overview.html"><a href="overview.html#rstudio-orientation"><i class="fa fa-check"></i><b>2.5</b> RStudio Orientation</a><ul>
<li class="chapter" data-level="2.5.1" data-path="overview.html"><a href="overview.html#rstudio-projects"><i class="fa fa-check"></i><b>2.5.1</b> RStudio Projects</a></li>
<li class="chapter" data-level="2.5.2" data-path="overview.html"><a href="overview.html#r-console"><i class="fa fa-check"></i><b>2.5.2</b> R Console</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="overview.html"><a href="overview.html#deep-thought"><i class="fa fa-check"></i><b>2.6</b> Deep thought</a></li>
<li class="chapter" data-level="2.7" data-path="overview.html"><a href="overview.html#r-scripts"><i class="fa fa-check"></i><b>2.7</b> R Scripts</a><ul>
<li class="chapter" data-level="2.7.1" data-path="overview.html"><a href="overview.html#deep-thought-error-messages-are-your-friends"><i class="fa fa-check"></i><b>2.7.1</b> Deep thought: Error messages are your friends</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="overview.html"><a href="overview.html#dont-save-the-workspace"><i class="fa fa-check"></i><b>2.8</b> Don’t save the workspace</a></li>
<li class="chapter" data-level="2.9" data-path="overview.html"><a href="overview.html#deep-thought-keep-the-raw-data-raw."><i class="fa fa-check"></i><b>2.9</b> Deep thought: keep the raw data raw.</a></li>
<li class="chapter" data-level="2.10" data-path="overview.html"><a href="overview.html#activity-1"><i class="fa fa-check"></i><b>2.10</b> Activity 1</a></li>
<li class="chapter" data-level="2.11" data-path="overview.html"><a href="overview.html#activity-2"><i class="fa fa-check"></i><b>2.11</b> Activity 2</a></li>
<li class="chapter" data-level="2.12" data-path="overview.html"><a href="overview.html#efficiency-tips"><i class="fa fa-check"></i><b>2.12</b> Efficiency Tips</a></li>
<li class="chapter" data-level="2.13" data-path="overview.html"><a href="overview.html#credit"><i class="fa fa-check"></i><b>2.13</b> Credit</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="readxl.html"><a href="readxl.html"><i class="fa fa-check"></i><b>3</b> <code>readxl</code></a><ul>
<li class="chapter" data-level="3.1" data-path="readxl.html"><a href="readxl.html#summary"><i class="fa fa-check"></i><b>3.1</b> Summary</a></li>
<li class="chapter" data-level="3.2" data-path="readxl.html"><a href="readxl.html#objectives"><i class="fa fa-check"></i><b>3.2</b> Objectives</a></li>
<li class="chapter" data-level="3.3" data-path="readxl.html"><a href="readxl.html#resources-1"><i class="fa fa-check"></i><b>3.3</b> Resources</a></li>
<li class="chapter" data-level="3.4" data-path="readxl.html"><a href="readxl.html#lesson"><i class="fa fa-check"></i><b>3.4</b> Lesson</a><ul>
<li class="chapter" data-level="3.4.1" data-path="readxl.html"><a href="readxl.html#lesson-prep-get-data-files-into-your-working-directory"><i class="fa fa-check"></i><b>3.4.1</b> Lesson prep: get data files into your working directory</a></li>
<li class="chapter" data-level="3.4.2" data-path="readxl.html"><a href="readxl.html#create-a-new-.r-script-attach-the-tidyverse-readxl-and-writexl-packages"><i class="fa fa-check"></i><b>3.4.2</b> Create a new .R script, attach the <code>tidyverse</code>, <code>readxl</code> and <code>writexl</code> packages</a></li>
<li class="chapter" data-level="3.4.3" data-path="readxl.html"><a href="readxl.html#use-readrread_csv-to-read-in-data-from-a-csv-file"><i class="fa fa-check"></i><b>3.4.3</b> Use <code>readr::read_csv()</code> to read in data from a CSV file</a></li>
<li class="chapter" data-level="3.4.4" data-path="readxl.html"><a href="readxl.html#use-readxlread_excel-to-read-in-a-single-excel-worksheet"><i class="fa fa-check"></i><b>3.4.4</b> Use <code>readxl::read_excel()</code> to read in a single Excel worksheet</a></li>
<li class="chapter" data-level="3.4.5" data-path="readxl.html"><a href="readxl.html#use-readxlread_excel-to-read-in-only-part-of-an-excel-worksheet"><i class="fa fa-check"></i><b>3.4.5</b> Use <code>readxl::read_excel()</code> to read in only <em>part</em> of an Excel worksheet</a></li>
<li class="chapter" data-level="3.4.6" data-path="readxl.html"><a href="readxl.html#use-readxlread_excel-to-read-in-selected-worksheets-from-a-workbook"><i class="fa fa-check"></i><b>3.4.6</b> Use <code>readxl::read_excel()</code> to read in selected worksheets from a workbook</a></li>
<li class="chapter" data-level="3.4.7" data-path="readxl.html"><a href="readxl.html#read-in-and-combine-data-from-multiple-worksheets-into-a-data-frame-simultaneously-with-purrrmap_df"><i class="fa fa-check"></i><b>3.4.7</b> Read in and combine data from multiple worksheets into a data frame simultaneously with <code>purrr::map_df()</code></a></li>
<li class="chapter" data-level="3.4.8" data-path="readxl.html"><a href="readxl.html#save-data-frames-as-.csv-or-.xlsx-with-readrwrite_csv-or-writexlwrite_xlsx"><i class="fa fa-check"></i><b>3.4.8</b> Save data frames as .csv or .xlsx with <code>readr::write_csv()</code> or <code>writexl::write_xlsx()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="readxl.html"><a href="readxl.html#fun-facts-ideas"><i class="fa fa-check"></i><b>3.5</b> Fun facts ideas:</a></li>
<li class="chapter" data-level="3.6" data-path="readxl.html"><a href="readxl.html#interludes-deep-thoughtsopenscapes"><i class="fa fa-check"></i><b>3.6</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="3.7" data-path="readxl.html"><a href="readxl.html#activity-import-some-invertebrates"><i class="fa fa-check"></i><b>3.7</b> Activity: Import some invertebrates!</a></li>
<li class="chapter" data-level="3.8" data-path="readxl.html"><a href="readxl.html#efficiency-tips-1"><i class="fa fa-check"></i><b>3.8</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>4</b> RMarkdown</a><ul>
<li class="chapter" data-level="4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#summary-a-few-sentences-1"><i class="fa fa-check"></i><b>4.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#objectives-more-detailed-bulletpoints-1"><i class="fa fa-check"></i><b>4.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="4.3" data-path="rmarkdown.html"><a href="rmarkdown.html#resources-2"><i class="fa fa-check"></i><b>4.3</b> Resources</a></li>
<li class="chapter" data-level="4.4" data-path="rmarkdown.html"><a href="rmarkdown.html#lessons-teaching-for-each-objective..-objectives-examples"><i class="fa fa-check"></i><b>4.4</b> Lessons teaching for each objective….. (objectives, examples)</a></li>
<li class="chapter" data-level="4.5" data-path="rmarkdown.html"><a href="rmarkdown.html#create-a-rmd-for-our-fish-analysis"><i class="fa fa-check"></i><b>4.5</b> Create a Rmd for our Fish analysis</a></li>
<li class="chapter" data-level="4.6" data-path="rmarkdown.html"><a href="rmarkdown.html#tidy-data"><i class="fa fa-check"></i><b>4.6</b> Tidy data</a></li>
<li class="chapter" data-level="4.7" data-path="rmarkdown.html"><a href="rmarkdown.html#fun-facts-quirky-things---making-a-note-of-these-wherever-possible-for-interest-little-did-you-know-sections"><i class="fa fa-check"></i><b>4.7</b> Fun facts (quirky things) - making a note of these wherever possible for interest (little “Did you know?” sections)</a></li>
<li class="chapter" data-level="4.8" data-path="rmarkdown.html"><a href="rmarkdown.html#interludes-deep-thoughtsopenscapes-1"><i class="fa fa-check"></i><b>4.8</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="4.9" data-path="rmarkdown.html"><a href="rmarkdown.html#interludes-deep-thoughtsopenscapes-2"><i class="fa fa-check"></i><b>4.9</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="4.10" data-path="rmarkdown.html"><a href="rmarkdown.html#our-turn-your-turn-1"><i class="fa fa-check"></i><b>4.10</b> Our Turn Your Turn 1</a></li>
<li class="chapter" data-level="4.11" data-path="rmarkdown.html"><a href="rmarkdown.html#our-turn-your-turn-2"><i class="fa fa-check"></i><b>4.11</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="4.12" data-path="rmarkdown.html"><a href="rmarkdown.html#efficiency-tips-2"><i class="fa fa-check"></i><b>4.12</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pivot.html"><a href="pivot.html"><i class="fa fa-check"></i><b>5</b> Dplyr and Pivot Tables</a><ul>
<li class="chapter" data-level="5.1" data-path="pivot.html"><a href="pivot.html#summary-a-few-sentences-2"><i class="fa fa-check"></i><b>5.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="5.2" data-path="pivot.html"><a href="pivot.html#objectives-more-detailed-bulletpoints-2"><i class="fa fa-check"></i><b>5.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="5.3" data-path="pivot.html"><a href="pivot.html#resources-3"><i class="fa fa-check"></i><b>5.3</b> Resources</a></li>
<li class="chapter" data-level="5.4" data-path="pivot.html"><a href="pivot.html#introduction-our-analytical-plan"><i class="fa fa-check"></i><b>5.4</b> Introduction / our analytical plan</a></li>
<li class="chapter" data-level="5.5" data-path="pivot.html"><a href="pivot.html#what-are-pivot-tables"><i class="fa fa-check"></i><b>5.5</b> What are pivot tables?</a></li>
<li class="chapter" data-level="5.6" data-path="pivot.html"><a href="pivot.html#dplyr-for-pivot-tables"><i class="fa fa-check"></i><b>5.6</b> dplyr for pivot tables</a></li>
<li class="chapter" data-level="5.7" data-path="pivot.html"><a href="pivot.html#deep-thought-1"><i class="fa fa-check"></i><b>5.7</b> Deep thought</a></li>
<li class="chapter" data-level="5.8" data-path="pivot.html"><a href="pivot.html#fun-facts-quirky-things---making-a-note-of-these-wherever-possible-for-interest-little-did-you-know-sections-1"><i class="fa fa-check"></i><b>5.8</b> Fun facts (quirky things) - making a note of these wherever possible for interest (little “Did you know?” sections)</a></li>
<li class="chapter" data-level="5.9" data-path="pivot.html"><a href="pivot.html#interludes-deep-thoughtsopenscapes-3"><i class="fa fa-check"></i><b>5.9</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="5.10" data-path="pivot.html"><a href="pivot.html#our-turn-your-turn-1-1"><i class="fa fa-check"></i><b>5.10</b> Our Turn Your Turn 1</a></li>
<li class="chapter" data-level="5.11" data-path="pivot.html"><a href="pivot.html#our-turn-your-turn-2-1"><i class="fa fa-check"></i><b>5.11</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="5.12" data-path="pivot.html"><a href="pivot.html#efficiency-tips-3"><i class="fa fa-check"></i><b>5.12</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vlookup.html"><a href="vlookup.html"><i class="fa fa-check"></i><b>6</b> Dplyr and vlookups</a><ul>
<li class="chapter" data-level="6.1" data-path="vlookup.html"><a href="vlookup.html#summary-1"><i class="fa fa-check"></i><b>6.1</b> Summary</a></li>
<li class="chapter" data-level="6.2" data-path="vlookup.html"><a href="vlookup.html#objectives-1"><i class="fa fa-check"></i><b>6.2</b> Objectives</a></li>
<li class="chapter" data-level="6.3" data-path="vlookup.html"><a href="vlookup.html#resources-4"><i class="fa fa-check"></i><b>6.3</b> Resources</a></li>
<li class="chapter" data-level="6.4" data-path="vlookup.html"><a href="vlookup.html#lessons"><i class="fa fa-check"></i><b>6.4</b> Lessons</a><ul>
<li class="chapter" data-level="6.4.1" data-path="vlookup.html"><a href="vlookup.html#dplyrfilter-to-conditionally-subset-by-rows"><i class="fa fa-check"></i><b>6.4.1</b> <code>dplyr::filter()</code> to conditionally subset by rows</a></li>
<li class="chapter" data-level="6.4.2" data-path="vlookup.html"><a href="vlookup.html#merging-data-frames-with-dplyr_join"><i class="fa fa-check"></i><b>6.4.2</b> Merging data frames with <code>dplyr::*_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="vlookup.html"><a href="vlookup.html#fun-facts"><i class="fa fa-check"></i><b>6.5</b> Fun facts</a></li>
<li class="chapter" data-level="6.6" data-path="vlookup.html"><a href="vlookup.html#interludes-deep-thoughtsopenscapes-4"><i class="fa fa-check"></i><b>6.6</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="6.7" data-path="vlookup.html"><a href="vlookup.html#our-turn-your-turn-1-2"><i class="fa fa-check"></i><b>6.7</b> Our Turn Your Turn 1</a></li>
<li class="chapter" data-level="6.8" data-path="vlookup.html"><a href="vlookup.html#our-turn-your-turn-2-2"><i class="fa fa-check"></i><b>6.8</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="6.9" data-path="vlookup.html"><a href="vlookup.html#efficiency-tips-4"><i class="fa fa-check"></i><b>6.9</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidying.html"><a href="tidying.html"><i class="fa fa-check"></i><b>7</b> Tidying</a><ul>
<li class="chapter" data-level="7.1" data-path="tidying.html"><a href="tidying.html#better-practices-needs-a-better-name"><i class="fa fa-check"></i><b>7.1</b> Better practices [needs a better name]</a></li>
<li class="chapter" data-level="7.2" data-path="tidying.html"><a href="tidying.html#summary-a-few-sentences-3"><i class="fa fa-check"></i><b>7.2</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="7.3" data-path="tidying.html"><a href="tidying.html#objectives-more-detailed-bulletpoints-3"><i class="fa fa-check"></i><b>7.3</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="7.4" data-path="tidying.html"><a href="tidying.html#resources-5"><i class="fa fa-check"></i><b>7.4</b> Resources</a></li>
<li class="chapter" data-level="7.5" data-path="tidying.html"><a href="tidying.html#lessons-teaching-for-each-objective..-objectives-examples-1"><i class="fa fa-check"></i><b>7.5</b> Lessons teaching for each objective….. (objectives, examples)</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tidying.html"><a href="tidying.html#expect-theres-a-better-way-chat"><i class="fa fa-check"></i><b>7.5.1</b> Expect there’s a better way chat</a></li>
<li class="chapter" data-level="7.5.2" data-path="tidying.html"><a href="tidying.html#janitor"><i class="fa fa-check"></i><b>7.5.2</b> Janitor</a></li>
<li class="chapter" data-level="7.5.3" data-path="tidying.html"><a href="tidying.html#example-how-to-google"><i class="fa fa-check"></i><b>7.5.3</b> Example: How to Google</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tidying.html"><a href="tidying.html#fun-facts-quirky-things---making-a-note-of-these-wherever-possible-for-interest-little-did-you-know-sections-2"><i class="fa fa-check"></i><b>7.6</b> Fun facts (quirky things) - making a note of these wherever possible for interest (little “Did you know?” sections)</a></li>
<li class="chapter" data-level="7.7" data-path="tidying.html"><a href="tidying.html#interludes-deep-thoughtsopenscapes-5"><i class="fa fa-check"></i><b>7.7</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="7.8" data-path="tidying.html"><a href="tidying.html#our-turn-your-turn-2-3"><i class="fa fa-check"></i><b>7.8</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="7.9" data-path="tidying.html"><a href="tidying.html#efficiency-tips-5"><i class="fa fa-check"></i><b>7.9</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="format.html"><a href="format.html"><i class="fa fa-check"></i><b>8</b> Formatting and Sharing</a><ul>
<li class="chapter" data-level="8.1" data-path="format.html"><a href="format.html#summary-a-few-sentences-4"><i class="fa fa-check"></i><b>8.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="8.2" data-path="format.html"><a href="format.html#objectives-more-detailed-bulletpoints-4"><i class="fa fa-check"></i><b>8.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="8.3" data-path="format.html"><a href="format.html#resources-6"><i class="fa fa-check"></i><b>8.3</b> Resources</a></li>
<li class="chapter" data-level="8.4" data-path="format.html"><a href="format.html#lessons-teaching-for-each-objective..-objectives-examples-2"><i class="fa fa-check"></i><b>8.4</b> Lessons teaching for each objective….. (objectives, examples)</a></li>
<li class="chapter" data-level="8.5" data-path="format.html"><a href="format.html#fun-facts-quirky-things---making-a-note-of-these-wherever-possible-for-interest-little-did-you-know-sections-3"><i class="fa fa-check"></i><b>8.5</b> Fun facts (quirky things) - making a note of these wherever possible for interest (little “Did you know?” sections)</a></li>
<li class="chapter" data-level="8.6" data-path="format.html"><a href="format.html#interludes-deep-thoughtsopenscapes-6"><i class="fa fa-check"></i><b>8.6</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="8.7" data-path="format.html"><a href="format.html#our-turn-your-turn-1-3"><i class="fa fa-check"></i><b>8.7</b> Our Turn Your Turn 1</a></li>
<li class="chapter" data-level="8.8" data-path="format.html"><a href="format.html#our-turn-your-turn-2-4"><i class="fa fa-check"></i><b>8.8</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="8.9" data-path="format.html"><a href="format.html#efficiency-tips-6"><i class="fa fa-check"></i><b>8.9</b> Efficiency Tips</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="synthesis.html"><a href="synthesis.html"><i class="fa fa-check"></i><b>9</b> Synthesis</a><ul>
<li class="chapter" data-level="9.1" data-path="synthesis.html"><a href="synthesis.html#summary-a-few-sentences-5"><i class="fa fa-check"></i><b>9.1</b> Summary (a few sentences)</a></li>
<li class="chapter" data-level="9.2" data-path="synthesis.html"><a href="synthesis.html#objectives-more-detailed-bulletpoints-5"><i class="fa fa-check"></i><b>9.2</b> Objectives (more detailed, bulletpoints?)</a></li>
<li class="chapter" data-level="9.3" data-path="synthesis.html"><a href="synthesis.html#resources-7"><i class="fa fa-check"></i><b>9.3</b> Resources</a></li>
<li class="chapter" data-level="9.4" data-path="synthesis.html"><a href="synthesis.html#lessons-teaching-for-each-objective..-objectives-examples-3"><i class="fa fa-check"></i><b>9.4</b> Lessons teaching for each objective….. (objectives, examples)</a></li>
<li class="chapter" data-level="9.5" data-path="synthesis.html"><a href="synthesis.html#fun-facts-quirky-things---making-a-note-of-these-wherever-possible-for-interest-little-did-you-know-sections-4"><i class="fa fa-check"></i><b>9.5</b> Fun facts (quirky things) - making a note of these wherever possible for interest (little “Did you know?” sections)</a></li>
<li class="chapter" data-level="9.6" data-path="synthesis.html"><a href="synthesis.html#interludes-deep-thoughtsopenscapes-7"><i class="fa fa-check"></i><b>9.6</b> Interludes (deep thoughts/openscapes)</a></li>
<li class="chapter" data-level="9.7" data-path="synthesis.html"><a href="synthesis.html#our-turn-your-turn-1-4"><i class="fa fa-check"></i><b>9.7</b> Our Turn Your Turn 1</a></li>
<li class="chapter" data-level="9.8" data-path="synthesis.html"><a href="synthesis.html#our-turn-your-turn-2-5"><i class="fa fa-check"></i><b>9.8</b> Our Turn Your Turn 2</a></li>
<li class="chapter" data-level="9.9" data-path="synthesis.html"><a href="synthesis.html#efficiency-tips-7"><i class="fa fa-check"></i><b>9.9</b> Efficiency Tips</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for the Excel User</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="vlookup" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Dplyr and vlookups</h1>
<div id="summary-1" class="section level2">
<h2><span class="header-section-number">6.1</span> Summary</h2>
<p>In Session 4, we learned how to do some basic wrangling and find summary information with functions in the <code>dplyr</code> package, which exists within the <code>tidyverse</code>. Those were:</p>
<p>TODO: Check this list (to see what actually gets covered in Session 4)</p>
<ul>
<li><code>dplyr::select()</code>: select which <strong>columns</strong> to retain or exclude</li>
<li><code>dplyr::mutate()</code>: <strong>add</strong> a new column, while keeping the existing ones</li>
<li><code>dplyr::group_by()</code>: let R know that <strong>groups</strong> exist within the dataset, by variable(s)</li>
<li><code>dplyr::summarize()</code>: calculate a value (that you specify) for each group, then report each group’s value in a table</li>
</ul>
<p>In Session 5, we’ll expand our data wrangling toolkit using:</p>
<ul>
<li><code>dplyr::filter()</code> to conditionally subset our data by <strong>rows</strong>, and</li>
<li><code>dplyr::join()</code> functions to merge data frames together</li>
</ul>
<p>The combination of <code>dplyr::filter()</code> and <code>dplyr::join()</code> - to return rows satisfying a condition we specify, and merging data frames by like variables - is analogous to the useful VLOOKUP function in Excel.</p>
</div>
<div id="objectives-1" class="section level2">
<h2><span class="header-section-number">6.2</span> Objectives</h2>
<ul>
<li>Continue building R Markdown skills</li>
<li>Return <strong>rows</strong> that satisfy variable conditions using <code>dplyr::filter()</code></li>
<li>Use <code>dplyr::full_join()</code>, <code>dplyr::inner_join()</code>, and beyond to merge data frames by matching variables, with different endpoints in mind</li>
<li>Use <code>dplyr::anti_join()</code> to find things that <strong>do not</strong> exist in both data frames</li>
<li>Understand the similarities between <code>dplyr::filter()</code> + <code>join()</code> and Excel’s <code>VLOOKUP</code></li>
</ul>
</div>
<div id="resources-4" class="section level2">
<h2><span class="header-section-number">6.3</span> Resources</h2>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/filter.html"><code>dplyr::filter()</code> documentation from tidyverse.org</a></li>
<li><a href="https://dplyr.tidyverse.org/reference/join.html"><code>dplyr::join()</code> documentation from tidyverse.org</a></li>
<li><a href="https://r4ds.had.co.nz/">Chapters 5 and 13 in <em>R for Data Science</em> by Garrett Grolemund and Hadley Wickham</a></li>
</ul>
</div>
<div id="lessons" class="section level2">
<h2><span class="header-section-number">6.4</span> Lessons</h2>
<p><strong>Session 5 set-up:</strong> TODO</p>
<ul>
<li>Create a new .Rmd within the r-and-excel directory (project) you created in Session 1</li>
<li>Add some descriptive text</li>
<li>Add new code chunks to:
<ul>
<li>Attach packages</li>
<li>Read in the necessary data</li>
</ul></li>
</ul>
<p>In this session we’ll use the <strong>fish_counts_curated.csv</strong> and <strong>invert_counts_curated.xlsx</strong> files, and the first worksheet from <strong>kelp_counts_curated.xlsx</strong>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Attach packages:</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># Read in data: </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">invert_counts &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;invert_counts_curated.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">fish_counts &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;fish_counts_curated.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">kelp_counts_abur &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;kelp_counts_curated.xlsx&quot;</span>)</a></code></pre></div>
<p>Remember to always explore the data you’ve read in using functions like <code>View()</code>, <code>names()</code>, <code>summary()</code>, <code>head()</code> and <code>tail()</code> to ensure that the data you <em>think</em> you read in is <em>actually</em> the data you read in.</p>
<p>Now, let’s use <code>dplyr::filter()</code> to decide which observations (rows) we’ll keep or exclude in new subsets, similar to using Excel’s VLOOKUP function.</p>
<div id="dplyrfilter-to-conditionally-subset-by-rows" class="section level3">
<h3><span class="header-section-number">6.4.1</span> <code>dplyr::filter()</code> to conditionally subset by rows</h3>
<p>Use <code>dplyr::filter()</code> to let R know which <strong>rows</strong> you want to keep or exclude, based on what they contain. Some examples in words:</p>
<ul>
<li>“I only want to keep rows where the temperature is greater than 90°F.”</li>
<li>“I want to keep all observations <strong>except</strong> those where the tree type is listed as <strong>unknown</strong>.”</li>
<li>“I want to make a new subset with only data for mountain lions (the species variable) in California (the state variable).”</li>
</ul>
<p>TODO: {Add filter image here}</p>
<p>When we use <code>dplyr::filter()</code>, we need to let R know a couple of things:</p>
<ul>
<li>What data frame we’re filtering from</li>
<li>What condition(s) we want observations to <strong>match</strong> and/or <strong>not match</strong> in order to keep them in the new subset</li>
</ul>
<p>Follow along with the examples below to learn some common ways to use <code>dplyr::filter()</code>.</p>
<div id="filter-rows-by-matching-a-single-character-string" class="section level4">
<h4><span class="header-section-number">6.4.1.1</span> Filter rows by matching a single character string</h4>
<p>Let’s say we want to keep all observations from the fish_counts data frame where the common name is “garibaldi.” Here, we need to tell R to only <em>keep rows</em> from the <strong>fish_counts</strong> data frame when the common name (<strong>common_name</strong> variable) exactly matches <strong>garibaldi</strong>.
Use <code>==</code> to ask R to look for matching strings:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">fish_gari &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(fish_counts, common_name <span class="op">==</span><span class="st"> &quot;garibaldi&quot;</span>)</a></code></pre></div>
<p>Check out the <strong>fish_gari</strong> object to ensure that only <em>garibaldi</em> observations remain.</p>
<p>You could also do this using the pipe operator <code>%&gt;%</code> (though for a single function, it doesn’t save much effort or typing):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">fish_gari &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(common_name <span class="op">==</span><span class="st"> &quot;garibaldi&quot;</span>)</a></code></pre></div>
</div>
<div id="filter-rows-based-on-numeric-conditions" class="section level4">
<h4><span class="header-section-number">6.4.1.2</span> Filter rows based on numeric conditions</h4>
<p>Use expected operators (&gt;, &lt;, &gt;=, &lt;=, =) to set conditions for a numeric variable when filtering. For this example, we only want to retain observations when the <strong>tot_count</strong> column value is &gt;= 50:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">fish_over50 &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(fish_counts, tot_count <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>)</a></code></pre></div>
<p>Or, using the pipe:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">fish_over50 &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(tot_count <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>)</a></code></pre></div>
</div>
<div id="filter-to-return-rows-that-match-this-or-that-or-that" class="section level4">
<h4><span class="header-section-number">6.4.1.3</span> Filter to return rows that match <em>this</em> OR <em>that</em> OR <em>that</em></h4>
<p>What if we want to return a subset of the fish_counts df that contains <em>garibaldi</em>, <em>blacksmith</em> OR <em>black surfperch</em>?</p>
<p>There are several ways to write an “OR” statement for filtering, which will keep any observations that match Condition A <em>or</em> Condition B <em>or</em> Condition C. In this example, we will create a subset from <strong>fish_counts</strong> that only contains rows where the <strong>common_name</strong> is <em>garibaldi</em> or <em>blacksmith</em> or <em>black surfperch</em>.</p>
<p>Use <code>%in%</code> to ask R to look for <em>any matches</em> within a combined vector of strings:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">fish_3sp &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(common_name <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;garibaldi&quot;</span>, <span class="st">&quot;blacksmith&quot;</span>, <span class="st">&quot;black surfperch&quot;</span>))</a></code></pre></div>
<p>Alternatively, you can indicate <strong>OR</strong> using the vertical line operator <code>|</code> to do the same thing (but you can see that it’s more repetitive when looking for matches within the same variable):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">fish_3sp &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(common_name <span class="op">==</span><span class="st"> &quot;garibaldi&quot;</span> <span class="op">|</span><span class="st"> </span>common_name <span class="op">==</span><span class="st"> &quot;blacksmith&quot;</span> <span class="op">|</span><span class="st"> </span>common_name <span class="op">==</span><span class="st"> &quot;black surfperch&quot;</span>)</a></code></pre></div>
</div>
<div id="filter-to-return-rows-that-match-conditions-for-multiple-variables" class="section level4">
<h4><span class="header-section-number">6.4.1.4</span> Filter to return rows that match conditions for multiple variables</h4>
<p>In the previous examples, we set filter conditions based on a single variable (e.g. common_name). What if we want to return observations that satisfy conditions for multiple variables?</p>
<p>For example: We want to create a subset that only returns rows from ‘invert_counts’ where the <strong>site</strong> is “abur” or “mohk” <em>and</em> the <strong>common_name</strong> is “purple urchin.” In <code>dplyr::filter()</code>, add a comma (or ampersand, &amp;) between arguments for multiple <em>AND</em> conditions:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">urchin_abur_mohk &lt;-<span class="st"> </span>invert_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(site <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;abur&quot;</span>,<span class="st">&quot;mohk&quot;</span>), common_name <span class="op">==</span><span class="st"> &quot;purple urchin&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">head</span>(urchin_abur_mohk)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 6
##   month site  common_name   `2016` `2017` `2018`
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 7     abur  purple urchin     48     48     48
## 2 7     mohk  purple urchin    620    505    323</code></pre>
<p>Like most things in R, there are other ways to do the same thing. For example, you could do the same thing using <code>&amp;</code> (instead of a comma) between “and” conditions:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Use the ampersand (&amp;) to add another condition &quot;and this must be true&quot;:</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">urchin_abur_mohk &lt;-<span class="st"> </span>invert_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(site <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;abur&quot;</span>,<span class="st">&quot;mohk&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>common_name <span class="op">==</span><span class="st"> &quot;purple urchin&quot;</span>)</a></code></pre></div>
<p>Or you could just do two filter steps in sequence:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Written as multiple filter steps:</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">urchin_abur_mohk &lt;-<span class="st"> </span>invert_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(site <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;abur&quot;</span>, <span class="st">&quot;mohk&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(common_name <span class="op">==</span><span class="st"> &quot;purple urchin&quot;</span>)</a></code></pre></div>
</div>
<div id="filter-to-return-rows-that-do-not-match-conditions" class="section level4">
<h4><span class="header-section-number">6.4.1.5</span> Filter to return rows that <em>do not</em> match conditions</h4>
<p>Sometimes we might want to exclude observations. Here, let’s say we want to make a subset that contains all rows from <strong>fish_counts</strong> except those recorded at the Mohawk Reef site (“mohk” in the <em>site</em> variable).</p>
<p>We use <code>!=</code> to return observations that <strong>do not match</strong> a condition.</p>
<p>Like this:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">fish_no_mohk &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(site <span class="op">!=</span><span class="st"> &quot;mohk&quot;</span>)</a></code></pre></div>
<p>This similarly works to exclude observations by a value.</p>
<p>For example, if we want to return all observations <em>except</em> those where the total fish count is 1, we use:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">fish_more_one &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(tot_count <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<p>What if we want to exclude observations for multiple conditions? For example, here we want to return all rows where the fish species <strong>is not</strong> garibaldi <strong>or</strong> rock wrasse.</p>
<p>We can use <code>filter(!variable %in% c(&quot;apple&quot;, &quot;orange&quot;))</code> to return rows where the variable does <strong>not</strong> match “apple” or “orange”. For our fish example, that looks like this:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">fish_subset &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>common_name <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;garibaldi&quot;</span>, <span class="st">&quot;rock wrasse&quot;</span>))</a></code></pre></div>
<p>Which then only returns observations for the other fish species in the dataset.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">head</span>(fish_subset)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##    year site  common_name     tot_count
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt;
## 1  2016 abur  black surfperch         2
## 2  2016 abur  blacksmith              1
## 3  2016 abur  senorita               58
## 4  2016 aque  black surfperch         1
## 5  2016 aque  blacksmith              1
## 6  2016 aque  senorita               57</code></pre>
</div>
<div id="example-some-combo-wprevious-functions-used" class="section level4">
<h4><span class="header-section-number">6.4.1.6</span> Example: Some combo w/previous functions used</h4>
<p>We can also use <code>dplyr::filter()</code> in combination with the functions we learned for wrangling yesterday. If we have multiple sequential steps to perform, we can string them together using the <em>pipe operator</em> (<code>%&gt;%</code>).</p>
</div>
</div>
<div id="merging-data-frames-with-dplyr_join" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Merging data frames with <code>dplyr::*_join()</code></h3>
<p>Excel’s <code>VLOOKUP</code> can also be used to merge data from separate tables or worksheets. Here, we’ll use the <code>dplyr::*_join()</code> functions to merge separate data frames in R.</p>
<p>There are a number of ways to merge data frames in R. We’ll use <code>full_join()</code> and <code>inner_join()</code> in this session.</p>
<p>From R Documentation (<code>?join</code>):</p>
<ul>
<li><code>dplyr::full_join()</code>: “returns all rows and all columns from both x and y. Where there are not matching values, returns NA for the one missing.” Basically, nothing gets thrown out, even if a match doesn’t exist - making <code>full_join()</code> the safest option for merging data frames.</li>
<li><code>dplyr::inner_join()</code>: “returns all rows from x where there are matching values in y, and all columns from x and y. If there are multiple matches between x and y, all combination of the matches are returned.” This will drop observations that don’t have a match between the merged data frames, which makes it a riskier merging option if you’re not sure what you’re trying to do. When in doubt, <code>full_join()</code>.</li>
</ul>
<div id="dplyrfull_join-to-merge-data-frames-keeping-everything" class="section level4">
<h4><span class="header-section-number">6.4.2.1</span> <code>dplyr::full_join()</code> to merge data frames, keeping everything</h4>
<p>When we join data frames in R, we need to tell R a couple of things (and it does the hard joining work for us):</p>
<ul>
<li>Which data frames we want to merge together</li>
<li>Which variables* to merge by</li>
</ul>
<p>Note: If there are <strong>exactly matching</strong> column names in the data frames you’re merging, the <code>*_join()</code> functions will assume that you want to join by those columns. If there are <em>no</em> matching column names, you can specify which columns to join by manually. We’ll do both here.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Join the fish_counts and kelp_counts_abur together: </span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">abur_kelp_join &lt;-<span class="st"> </span>fish_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">full_join</span>(kelp_counts_abur) <span class="co"># Uh oh</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co"># An interesting error we haven&#39;t dealt with before</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co"># The &#39;year&#39; variable in &#39;kelp_counts_abur&#39; is a &quot;character&quot; class! </span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co"># Why? Because the values in the Excel worksheet were stored as text</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co"># Open the Excel file &amp; see warning/left alignment - not a value</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co"># But that&#39;s OK, because we can tell R to understand that variable as numeric</span></a></code></pre></div>
</div>
<div id="dplyrinner_join-to-merge-data-frames-only-keeping-observations-with-a-match-in-both" class="section level4">
<h4><span class="header-section-number">6.4.2.2</span> <code>dplyr::inner_join()</code> to merge data frames, only keeping observations with a match in both</h4>
</div>
</div>
</div>
<div id="fun-facts" class="section level2">
<h2><span class="header-section-number">6.5</span> Fun facts</h2>
<p><strong>How is this similar to <code>VLOOKUP</code> in Excel? How does it differ?</strong></p>
<p>From <a href="https://support.office.com/en-us/article/vlookup-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1">Microsoft Office Support</a>, “use VLOOKUP when you need to find things in a table or a range by row.”</p>
<p>So, both <code>filter()</code> and <code>VLOOKUP</code> look through your data frame (or spreadsheet, in Excel) to look for observations that match your conditions. But they also differ in important ways:</p>
<ol style="list-style-type: decimal">
<li><p>By default <code>VLOOKUP</code> looks for and returns an observation for <em>approximate</em> matches (and you have to change the final argument to FALSE to look for an exact match). In contrast, by default <code>dplyr::filter()</code> will look for exact conditional matches.</p></li>
<li><p><code>VLOOKUP</code> will look for and return information from the <em>first observation</em> that matches (or approximately matches) a condition. <code>dplyr::filter()</code> will return all observations (rows) that exactly match a condition.</p></li>
</ol>
</div>
<div id="interludes-deep-thoughtsopenscapes-4" class="section level2">
<h2><span class="header-section-number">6.6</span> Interludes (deep thoughts/openscapes)</h2>
<ul>
<li>Idea: not overusing the pipe in really long sequences. What are other options? Why is that a concern? What are some ways to always know that what’s happening in a sequence is what you EXPECT is happening in a sequence? tidylog, check intermediate data frames, sometimes write intermediate data frames, etc.</li>
</ul>
</div>
<div id="our-turn-your-turn-1-2" class="section level2">
<h2><span class="header-section-number">6.7</span> Our Turn Your Turn 1</h2>
</div>
<div id="our-turn-your-turn-2-2" class="section level2">
<h2><span class="header-section-number">6.8</span> Our Turn Your Turn 2</h2>
</div>
<div id="efficiency-tips-4" class="section level2">
<h2><span class="header-section-number">6.9</span> Efficiency Tips</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pivot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidying.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["R for Excel Users.pdf", "R for Excel Users.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
